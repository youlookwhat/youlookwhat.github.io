<!DOCTYPE html>


  <html class="light page-post">


<head>
  <meta charset="utf-8">
  
  <title>《Android群英传 神兵利器》读书笔记 | JingBin&#39;s Home</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="Android,Books,工具," />
  

  <meta name="description" content="《Android群英传 神兵利器》 - Android开发的工具使用">
<meta property="og:type" content="article">
<meta property="og:title" content="《Android群英传 神兵利器》读书笔记">
<meta property="og:url" content="http://jinbeen.com/2018/02/04/《Android群英传-神兵利器》读书笔记/index.html">
<meta property="og:site_name" content="JingBin's Home">
<meta property="og:description" content="《Android群英传 神兵利器》 - Android开发的工具使用">
<meta property="og:updated_time" content="2018-06-06T16:22:22.868Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="《Android群英传 神兵利器》读书笔记">
<meta name="twitter:description" content="《Android群英传 神兵利器》 - Android开发的工具使用">

  

  
    <link rel="icon" href="/favicon.ico">
  

  <link href="/css/styles.css?v=c114cbeddx" rel="stylesheet">


  
    <link rel="stylesheet" href="/css/personal-style.css">
  

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'G-91L2DT6NQB', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?643275289e816ea38d7a840456d91ebd";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  
  <script type="text/javascript">
	(function(){
	    var bp = document.createElement('script');
	    var curProtocol = window.location.protocol.split(':')[0];
	    if (curProtocol === 'https') {
	        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
	    }
	    else {
	        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
	    }
	    var s = document.getElementsByTagName("script")[0];
	    s.parentNode.insertBefore(bp, s);
	})();
  </script>



  
    <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

</head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">盒子</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">盒子</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/archives/"
            rel="noopener noreferrer"
            target="_self"
            >
            博客
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/categories/Android"
            rel="noopener noreferrer"
            target="_self"
            >
            分类
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tags/Android"
            rel="noopener noreferrer"
            target="_self"
            >
            标签
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/link/"
            rel="noopener noreferrer"
            target="_self"
            >
            友链
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            关于
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/music.html"
            rel="noopener noreferrer"
            target="_self"
            >
            Music
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/atom.xml"
            rel="noopener noreferrer"
            target="_blank"
            >
            RSS
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#与Gradle的爱恨情仇"><span class="toc-text">与Gradle的爱恨情仇</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#配置全局参数"><span class="toc-text">配置全局参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#构建defaultConfig"><span class="toc-text">构建defaultConfig</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#构建buildTypes"><span class="toc-text">构建buildTypes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#关于签名"><span class="toc-text">关于签名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#可选配置"><span class="toc-text">可选配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#构建Proguard-混淆"><span class="toc-text">构建Proguard 混淆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#动态设置参数"><span class="toc-text">动态设置参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#多渠道打包"><span class="toc-text">多渠道打包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他注意事项"><span class="toc-text">其他注意事项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Grovvy"><span class="toc-text">Grovvy</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#深藏功与名的开发者工具"><span class="toc-text">深藏功与名的开发者工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AAPT"><span class="toc-text">AAPT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lint"><span class="toc-text">Lint</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#无线调试"><span class="toc-text">无线调试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9Patch工具"><span class="toc-text">9Patch工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hierarchy-viewer"><span class="toc-text">Hierarchy viewer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看UI"><span class="toc-text">查看UI</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#开发者模式"><span class="toc-text">开发者模式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#App背后的故事-性能检测与分析工具"><span class="toc-text">App背后的故事 - 性能检测与分析工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#UI性能分析"><span class="toc-text">UI性能分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#内存区分"><span class="toc-text">内存区分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GC系统"><span class="toc-text">GC系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#获取更多内存"><span class="toc-text">获取更多内存</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#通过子线程"><span class="toc-text">通过子线程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Native-Heap"><span class="toc-text">Native Heap</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#openGL"><span class="toc-text">openGL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LargeHeap"><span class="toc-text">LargeHeap</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#系统内存警告"><span class="toc-text">系统内存警告</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#检测内存泄漏工具"><span class="toc-text">检测内存泄漏工具</span></a></li></ol></li></ol></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-《Android群英传-神兵利器》读书笔记" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">《Android群英传 神兵利器》读书笔记</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2018.02.04</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>JingBin</span>
        </span>
      

      
  <span class="article-category">
    <i class="icon-list"></i>
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </span>



      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbsp热度 <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>℃
        </span>
      
      
    </div>
  </header>

  <div class="article-content">
    
      <blockquote>
<p><a href="https://book.douban.com/subject/26855851/" target="_blank" rel="external">《Android群英传 神兵利器》</a> - Android开发的工具使用</p>
</blockquote>
<a id="more"></a>
<p>这是一本Android开发的工具书，里面的提到的工具基本上是每个Android开发者必备的技能，买这本书的起因是看到有介绍Gradle和性能优化。里面提到的很多工具之前都是用过，所以看得很快，只care自己不熟知的，所以这篇读书笔记是对自己不熟的地方的整理和摘录。</p>
<h2 id="与Gradle的爱恨情仇"><a href="#与Gradle的爱恨情仇" class="headerlink" title="与Gradle的爱恨情仇"></a>与Gradle的爱恨情仇</h2><h3 id="配置全局参数"><a href="#配置全局参数" class="headerlink" title="配置全局参数"></a>配置全局参数</h3><blockquote>
<p>配置后就可以统一管理<code>com.android.support:design</code>版本号了</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">根目录的build.gradle中</div><div class="line">ext &#123;</div><div class="line">    <span class="comment">// Support library and architecture components support minSdk 19 and above.</span></div><div class="line">    minSdkVersion = <span class="number">19</span></div><div class="line">    targetSdkVersion = <span class="number">26</span></div><div class="line">    compileSdkVersion = <span class="number">26</span></div><div class="line">    buildToolsVersion = <span class="string">'26.0.2'</span></div><div class="line"></div><div class="line">    <span class="comment">// App dependencies</span></div><div class="line">    supportLibraryVersion = <span class="string">'27.0.2'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>使用：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">defaultConfig &#123;</div><div class="line">        applicationId <span class="string">"com.example.jingbin.cloudreader"</span></div><div class="line">        minSdkVersion rootProject.ext.minSdkVersion</div><div class="line">        targetSdkVersion rootProject.ext.targetSdkVersion</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">compile <span class="string">"com.android.support:design:$rootProject.supportLibraryVersion"</span></div></pre></td></tr></table></figure>
<h3 id="构建defaultConfig"><a href="#构建defaultConfig" class="headerlink" title="构建defaultConfig"></a>构建defaultConfig</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">defaultConfig&#123;</div><div class="line">  <span class="function">versionName <span class="title">getCustomVersionName</span><span class="params">()</span></span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">// build.gradle定义方法：</span></div><div class="line">def getCustomVersionName&#123;</div><div class="line"> ......</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="构建buildTypes"><a href="#构建buildTypes" class="headerlink" title="构建buildTypes"></a>构建buildTypes</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">buildTypes&#123;</div><div class="line">  <span class="comment">// xys.initWith(buildTypes.debug) 也可以继承其他的构建类型</span></div><div class="line">  xys&#123;</div><div class="line">     applicationIdSuffix <span class="string">".xys"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>gradle assembleDebug / assembleRelease / <code>assembleXys</code></p>
<p>生成另一个包，在包名后加上”.xys”，这样就可以双开了，不用手动更改包名！</p>
<h3 id="关于签名"><a href="#关于签名" class="headerlink" title="关于签名"></a>关于签名</h3><p>签名文件保存在住module的根目录下。<br>系统有一个默认的debug签名</p>
<p>Android Studio中签名文件是“.jks”文件<br>Eclipse中签名文件是”.keystore”文件</p>
<p>配置签名：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">signingConfigs&#123;</div><div class="line">  xys&#123;</div><div class="line">  		...</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="可选配置"><a href="#可选配置" class="headerlink" title="可选配置"></a>可选配置</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">CompileOptions : 配置编译的选项 JDK</div><div class="line"><span class="comment">// 使用lint检查代码时错误的话停止，加上这个之后就会继续，但是一般不启动lint，因为启动后会编译很慢</span></div><div class="line">lintOptions&#123;</div><div class="line">	abortOnError <span class="keyword">false</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="构建Proguard-混淆"><a href="#构建Proguard-混淆" class="headerlink" title="构建Proguard 混淆"></a>构建Proguard 混淆</h3><blockquote>
<p>混淆能精简代码、资源、优化代码</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">buildTypes &#123;</div><div class="line">        release &#123;</div><div class="line">            <span class="comment">// 混淆</span></div><div class="line">            minifyEnabled <span class="keyword">true</span></div><div class="line">            <span class="comment">// Zipalign优化</span></div><div class="line">            zipAlignEnabled <span class="keyword">true</span></div><div class="line">            <span class="comment">// 移除无用的resource文件</span></div><div class="line">            shrinkResources <span class="keyword">true</span></div><div class="line">            <span class="comment">// 前一部分代表系统默认的android程序的混淆文件，该文件已经包含了基本的混淆声明，后一个文件是自己的定义混淆文件</span></div><div class="line">            <span class="function">proguardFiles <span class="title">getDefaultProguardFile</span><span class="params">(<span class="string">'proguard-android.txt'</span>)</span>, 'proguard-rules.pro'</span></div><div class="line">            signingConfig signingConfigs.release</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h3 id="动态设置参数"><a href="#动态设置参数" class="headerlink" title="动态设置参数"></a>动态设置参数</h3><p>使用key/value的方式，引入签名的配置，而不是直接写入，这样会增强安全性，特别是对于开源项目</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//配置签名文件</span></div><div class="line">    signingConfigs &#123;</div><div class="line">        release &#123;</div><div class="line">            <span class="function">storeFile <span class="title">file</span><span class="params">(pStoreFile)</span></span></div><div class="line">            storePassword pStorePassword</div><div class="line">            keyAlias pKeyAlias</div><div class="line">            keyPassword pKeyPassword</div><div class="line">        &#125;</div><div class="line">        debug &#123;</div><div class="line">            <span class="function">storeFile <span class="title">file</span><span class="params">(pStoreFile)</span></span></div><div class="line">            storePassword pStorePassword</div><div class="line">            keyAlias pKeyAlias</div><div class="line">            keyPassword pKeyPassword</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>然后在<code>gradle.properties</code>中配置</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># 签名信息</div><div class="line">pStoreFile = ./xxxxx.keystore</div><div class="line">pStorePassword = xxxxx</div><div class="line">pKeyAlias = xxxxx</div><div class="line">pKeyPassword = xxxxx</div></pre></td></tr></table></figure>
<h3 id="多渠道打包"><a href="#多渠道打包" class="headerlink" title="多渠道打包"></a>多渠道打包</h3><blockquote>
<p>过程相对比较复杂，且网上很多教程，AS3.0和以上的版本略有不同就不列出详细信息</p>
</blockquote>
<p>在清单文件创建占位符 -&gt; 配脚本 -&gt; 生成重命名包(注意AS3.0变化)</p>
<p><strong><em>系统有一个BuildConfig类文件，是无法改变值的。</em></strong>里面有一些常用的配置参数，比如版本号什么的，我们可以手动配置，然后从这个类里面取值。<br>手动配置：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">buildTypes&#123;</div><div class="line">  xys&#123;</div><div class="line">     buildConfigField <span class="string">"boolean"</span>,<span class="string">"testFlag"</span>,<span class="string">"false"</span></div><div class="line">     signingConfig signingConfig.xys</div><div class="line">     applicaitonIdSuffix <span class="string">".xys"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这样：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">BuildConfig</span></span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">boolean</span> DEBUG = Boolean.parseBoolean(<span class="string">"true"</span>);</div><div class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String APPLICATION_ID = <span class="string">"com.example.jingbin.cloudreader"</span>;</div><div class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String BUILD_TYPE = <span class="string">"debug"</span>;</div><div class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String FLAVOR = <span class="string">""</span>;</div><div class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> VERSION_CODE = <span class="number">14</span>;</div><div class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String VERSION_NAME = <span class="string">"2.0.0"</span>;</div><div class="line">  <span class="comment">// Fields from build type: xys 额外生成了这个</span></div><div class="line">  pubic <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">boolean</span> testFlag = <span class="keyword">false</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="其他注意事项"><a href="#其他注意事项" class="headerlink" title="其他注意事项"></a>其他注意事项</h3><p>引用Maven中央库：</p>
<ul>
<li><a href="http://mvnrepository.com/" target="_blank" rel="external">http://mvnrepository.com/</a> 上传和使用</li>
<li>使用Gradle上传aar到Maven库</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//    gradle编译加速</span></div><div class="line">    dexOptions &#123;</div><div class="line">        incremental <span class="keyword">true</span></div><div class="line">        javaMaxHeapSize <span class="string">"4g"</span></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>不同包或相同包下，最好不要出现相同的文件，Merge到一起时，相同的资源名就会发生冲突！</p>
</blockquote>
<h3 id="Grovvy"><a href="#Grovvy" class="headerlink" title="Grovvy"></a>Grovvy</h3><blockquote>
<p>Grovvy(语言)对于Gradle(脚本)，好比于Java对于Android。</p>
</blockquote>
<p>Grovvy核心是Task。<br>Task依赖：增加一个依赖方法，连接起来，让不在一起的Task能够有一个先后执行的关系。</p>
<table>
<thead>
<tr>
<th style="text-align:center">三个阶段</th>
<th style="text-align:center">do Something</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Initiliacation</td>
<td style="text-align:center">初始化阶段，执行项目中的setting.gradle脚本</td>
</tr>
<tr>
<td style="text-align:center">Configration</td>
<td style="text-align:center">解析每个Profect中的build.gradle脚本，生成有向关系图–tashgrash</td>
</tr>
<tr>
<td style="text-align:center">Build</td>
<td style="text-align:center">编译运行阶段，按照tashgraph执行编译</td>
</tr>
</tbody>
</table>
<h2 id="深藏功与名的开发者工具"><a href="#深藏功与名的开发者工具" class="headerlink" title="深藏功与名的开发者工具"></a>深藏功与名的开发者工具</h2><h3 id="AAPT"><a href="#AAPT" class="headerlink" title="AAPT"></a>AAPT</h3><blockquote>
<p>Android Asset Packaging Tool  -&gt; SDK - build-tools</p>
</blockquote>
<p>可以查看，创建，修改压缩文件(Zip、jar、APK),也可将资源编译成二进制文件。<br>查看报信息，资源目录等。</p>
<h3 id="Lint"><a href="#Lint" class="headerlink" title="Lint"></a>Lint</h3><p>用于检测各项目中(包含库)中的一些错误问题，比如资源未用或过时的api等。<br>在AS命令行使用<code>gradle lint</code>。(如果gradle版本更新则要更改配置)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 使用lint检查代码时错误的话停止，加上这个之后就会继续，但是一般不启动lint，因为启动后会编译很慢</span></div><div class="line">lintOptions&#123;</div><div class="line">	abortOnError <span class="keyword">false</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="无线调试"><a href="#无线调试" class="headerlink" title="无线调试"></a>无线调试</h3><p>基于ADB的TCP/IP模式 - 《图解TCP/IP》</p>
<h3 id="9Patch工具"><a href="#9Patch工具" class="headerlink" title="9Patch工具"></a>9Patch工具</h3><p>SDK -&gt; tools -&gt; draw9patch(画单边就行)<br>在AS中点击鼠标右键生成9patch图</p>
<h3 id="Hierarchy-viewer"><a href="#Hierarchy-viewer" class="headerlink" title="Hierarchy viewer"></a>Hierarchy viewer</h3><p>检测UI性能的工具<br>testCompile 只有Debug生效，Release解除</p>
<h3 id="查看UI"><a href="#查看UI" class="headerlink" title="查看UI"></a>查看UI</h3><blockquote>
<p>iautomatorviewer</p>
</blockquote>
<h3 id="开发者模式"><a href="#开发者模式" class="headerlink" title="开发者模式"></a>开发者模式</h3><blockquote>
<p>调试GPU过渡绘制</p>
</blockquote>
<h2 id="App背后的故事-性能检测与分析工具"><a href="#App背后的故事-性能检测与分析工具" class="headerlink" title="App背后的故事 - 性能检测与分析工具"></a>App背后的故事 - 性能检测与分析工具</h2><h3 id="UI性能分析"><a href="#UI性能分析" class="headerlink" title="UI性能分析"></a>UI性能分析</h3><ul>
<li>调试GPU过渡绘制</li>
<li>16ms黄金准则</li>
<li>布局核心准则：<ul>
<li>尽量使布局的view树扁平，降低布局的层次</li>
<li><strong>Google建议View不宜超过8层</strong></li>
<li>使用组合控件</li>
</ul>
</li>
<li>LinearLayout与RelativeLayout<ul>
<li>使用LinearLayout：保证层级不深</li>
<li>使用RelativeLayout：避免嵌套</li>
</ul>
</li>
</ul>
<ul>
<li>Hierarchy viewer：检测UI性能的工具</li>
<li>Merge与Viewstub  布局懒加载</li>
<li>图片重绘 Overdraw<ul>
<li>Debug Gpu Overdraw查看重绘界面</li>
<li>1、改善布局，避免重叠</li>
<li>2、控件与主背景颜色相同：可移除控件背景</li>
<li>3、自定义view背景，使用dipRect属性减少重绘区域</li>
</ul>
</li>
<li>Profile Gpu rendering<ul>
<li>在开发者模式中，GPU呈现模式分析 -&gt; 在屏幕上显示条形图</li>
</ul>
</li>
</ul>
<h3 id="内存区分"><a href="#内存区分" class="headerlink" title="内存区分"></a>内存区分</h3><blockquote>
<ul>
<li>寄存器 Registers：用于存储指令、地址、数据。</li>
<li>栈 Stack：存放基本类型的数据、对象的引用和函数地址等，由系统控制。</li>
<li>堆 Heap：存放对象本身和数组，由开发者控制。</li>
<li>静态域 static field：存储静态变量。</li>
<li>常量池 constant pool：存储常量。</li>
</ul>
</blockquote>
<p>开发者能够控制的内存，基本在于堆和栈区域，他们的区别如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">堆/栈</th>
<th style="text-align:center">GC管理</th>
<th style="text-align:center">存取速度</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">推</td>
<td style="text-align:center">由GC系统控制。变量生命周期结束后，由GC系统决定何时回收</td>
<td style="text-align:center">慢</td>
</tr>
<tr>
<td style="text-align:center">栈</td>
<td style="text-align:center">由虚拟机控制。变量生命周期结束后，由虚拟机释放该变量占用的内存空间</td>
<td style="text-align:center">快</td>
</tr>
</tbody>
</table>
<p>常用的内存类型：</p>
<ul>
<li>VSS - Virtual Set Size 虚拟耗用内存（包含共享库占用的内存）。</li>
<li>RSS - Resident Set Size 实际使用物理内存（包含共享库占用的内存）。</li>
<li>PSS - Proportinal Set size 实际使用的物理内存（比例分配共享库占用的内存）。</li>
<li>USS - Unique Set Size 进程独自占用的物理内存（不包含共享库占用的内存）。</li>
</ul>
<p>一般来说内存占用大小有如下规律：VSS≥RSS≥PSS≥USS</p>
<h3 id="GC系统"><a href="#GC系统" class="headerlink" title="GC系统"></a>GC系统</h3><p>GC系统遵循GC Root搜索算法，根据是否包含其他对象的引用来判断是否需要进行GC。在Android2.3之后，系统修改了GC，将GC作为并发线程，同时每次GC并不会遍历整个Heap，而是只遍历一部分内存。</p>
<p>GC系统根据GC Root算法进行GC工作，该算法会以一个GC Root对象为起点，搜索与之相关联的对象。如果某个对象与GC Root对象没有找到引用链，则表示該对象需要进行回收，常见的GCRoot对象有以下几种。</p>
<ul>
<li>class：由System class loader 加载的对象。</li>
<li>JNI：jni相关调用的引用、变量、参数。</li>
<li>Thread：活着的线程。</li>
<li>Stack：栈中的对象。</li>
<li>静态：方法区类的静态属性引用的对象。</li>
<li>常量：方法区中的常量引用的对象（final类型）。</li>
</ul>
<h3 id="获取更多内存"><a href="#获取更多内存" class="headerlink" title="获取更多内存"></a>获取更多内存</h3><h4 id="通过子线程"><a href="#通过子线程" class="headerlink" title="通过子线程"></a>通过子线程</h4><blockquote>
<p>安卓系统的内存分配通过进程分配。</p>
</blockquote>
<p>WebView内存回收非常麻烦，需要运行在单独进程中(android:process)。<br>然后通过kill process回收内存。</p>
<h4 id="Native-Heap"><a href="#Native-Heap" class="headerlink" title="Native Heap"></a>Native Heap</h4><blockquote>
<p>安卓系统限制的是JavaHeap的内存大小。</p>
</blockquote>
<p>系统控制的，不受大小限制  -&gt; Fresco.</p>
<h4 id="openGL"><a href="#openGL" class="headerlink" title="openGL"></a>openGL</h4><blockquote>
<p>图像处理</p>
</blockquote>
<h4 id="LargeHeap"><a href="#LargeHeap" class="headerlink" title="LargeHeap"></a>LargeHeap</h4><p>通过清单文件配置<br>加大GC难度，使GC变慢，退到后台时，很容易被回收。</p>
<h4 id="系统内存警告"><a href="#系统内存警告" class="headerlink" title="系统内存警告"></a>系统内存警告</h4><blockquote>
<p>根据情况释放内存</p>
</blockquote>
<ul>
<li>onLowMemory</li>
<li>onTrimMemory</li>
</ul>
<h4 id="检测内存泄漏工具"><a href="#检测内存泄漏工具" class="headerlink" title="检测内存泄漏工具"></a>检测内存泄漏工具</h4><ul>
<li>MAT - Memory Analysis Tool</li>
<li>LeakCanary</li>
</ul>

    
  </div>

</article>


   
  <div class="text-center donation">
    <div class="inner-donation">
      <span class="btn-donation">支持一下</span>
      <div class="donation-body">
        <div class="tip text-center">扫一扫，支持我</div>
        <ul>
        
          <li class="item">
            
              <span>微信扫一扫</span>
            
            <img src="https://raw.githubusercontent.com/youlookwhat/CloudReader/master/file/Wechat-admire.jpg" alt="">
          </li>
        
          <li class="item">
            
              <span>支付宝扫一扫</span>
            
            <img src="https://raw.githubusercontent.com/youlookwhat/CloudReader/master/file/alipay-admire.jpg" alt="">
          </li>
        
        </ul>
      </div>
    </div>
  </div>


   
  <div class="box-prev-next clearfix">
    <a class="show pull-left" href="/2018/02/02/京东CPS商品推广接入流程/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="show pull-right" href="/2018/04/13/《Android开发艺术探索》读书笔记/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>




</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">关闭</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              rel="noopener noreferrer"
              target="_self"
              >
              博客
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/categories/Android"
              rel="noopener noreferrer"
              target="_self"
              >
              分类
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tags/Android"
              rel="noopener noreferrer"
              target="_self"
              >
              标签
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/link/"
              rel="noopener noreferrer"
              target="_self"
              >
              友链
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              关于
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/music.html"
              rel="noopener noreferrer"
              target="_self"
              >
              Music
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/atom.xml"
              rel="noopener noreferrer"
              target="_blank"
              >
              RSS
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    

    

    
    

    

    
    

    

<!-- Gitalk评论插件通用代码 -->
<div id="gitalk-container"></div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js"></script>
<script>
const gitalk = new Gitalk({
  clientID: '2b303b849c8ea65e4051',
  clientSecret: '57fc88550a6d86d10a191bb7b6411072576c00b3',
  repo: 'blog-comment',
  owner: 'youlookwhat',
  // 在这里设置一下截取前50个字符串, 这是因为 github 对 label 的长度有了要求, 如果超过
  // 50个字符串则会报错.
  // id: location.pathname.split('/').pop().substring(0, 49),
  id: md5(location.pathname),
  admin: ['youlookwhat'],
  // facebook-like distraction free mode
  distractionFreeMode: false
})
gitalk.render('gitalk-container')
</script>
<!-- Gitalk代码结束 -->



  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

</body>
</html>
